<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.22">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>introduction – Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b4406b7675125bc2ba204020e191172.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f1abceebc010e40e517e9f9503608e7d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./graphics/vblogoedit.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Final Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Executive Summary</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./overview.html"> 
<span class="menu-text">Literature Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mcmc.html"> 
<span class="menu-text">MCMC</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-method-reproduction" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Method Reproduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-method-reproduction">    
        <li>
    <a class="dropdown-item" href="./introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./methods.html">
 <span class="dropdown-text">Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./conclusions.html">
 <span class="dropdown-text">Conlusions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./team.html"> 
<span class="menu-text">Statement of author contributions</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/yaoyusi1109/STAT4664_final"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">1. Data Collection</a>
  <ul class="collapse">
  <li><a href="#plasmodium-falciparum-parasite" id="toc-plasmodium-falciparum-parasite" class="nav-link" data-scroll-target="#plasmodium-falciparum-parasite">Plasmodium Falciparum (parasite)</a></li>
  <li><a href="#anopheles-gambiae-mosquitoes" id="toc-anopheles-gambiae-mosquitoes" class="nav-link" data-scroll-target="#anopheles-gambiae-mosquitoes">Anopheles Gambiae (mosquitoes)</a></li>
  </ul></li>
  <li><a href="#bayesian-inference-workflow" id="toc-bayesian-inference-workflow" class="nav-link" data-scroll-target="#bayesian-inference-workflow">2. Bayesian Inference Workflow</a>
  <ul class="collapse">
  <li><a href="#define-a-likelihood-function" id="toc-define-a-likelihood-function" class="nav-link" data-scroll-target="#define-a-likelihood-function">1. Define a Likelihood Function</a></li>
  <li><a href="#specify-prior-distributions" id="toc-specify-prior-distributions" class="nav-link" data-scroll-target="#specify-prior-distributions">2. Specify Prior Distributions</a></li>
  <li><a href="#sample-from-the-posterior-via-mcmc" id="toc-sample-from-the-posterior-via-mcmc" class="nav-link" data-scroll-target="#sample-from-the-posterior-via-mcmc">3. Sample from the Posterior via MCMC</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>Predicting how diseases like malaria spread is a big challenge, especially as climate change shifts global temperature patterns. A key part of this prediction involves understanding how temperature affects different biological traits of mosquitoes and the parasites they carry — for example, how quickly mosquitoes develop (MDR), how fast the malaria parasite matures inside them (PDR), or how often mosquitoes bite humans. These temperature-sensitive traits are used to calculate something called the basic reproduction number, or R_0, which tells us how easily a disease can spread in a population.</p>
<p>The problem is that reliable data for these traits — especially at different temperatures — is limited and often noisy. Instead of drawing a single best-fit curve through the data, the paper we are following uses a Bayesian approach with a technique called Markov Chain Monte Carlo (MCMC) to model the uncertainty. This method creates a range of possible trait curves, not just one, and gives us a clearer picture of how confident we are in the estimates.</p>
</section>
<section id="data-collection" class="level2">
<h2 class="anchored" data-anchor-id="data-collection">1. Data Collection</h2>
<p>The authors assembled two types of datasets:</p>
<ul>
<li><strong>Main data</strong>: Laboratory data under constant temperature, focused on Anopheles gambiae and Plasmodium falciparum. These data were only available for three traits mosquito development rate (MDR), egg-to-adult survival (pEA), and adult mosquito mortality (<span class="math inline">\(\mu\)</span>). For other traits ideal data, the researcher used data from related species.</li>
<li><strong>Prior data</strong>: A broader set that included similar traits from related species and less controlled experiments. This dataset was used to construct informative priors in the Bayesian models.</li>
</ul>
<section id="plasmodium-falciparum-parasite" class="level3">
<h3 class="anchored" data-anchor-id="plasmodium-falciparum-parasite">Plasmodium Falciparum (parasite)</h3>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d2be02b4e55e93393c07" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d2be02b4e55e93393c07">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"25\" data-max=\"43\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;,&quot;na&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"16\" data-max=\"20\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["EIP (extrinsic incubation period)","EIP (extrinsic incubation period)","EIP (extrinsic incubation period)","EIP (extrinsic incubation period)","EIP (extrinsic incubation period)","EIP (extrinsic incubation period)","EIP (extrinsic incubation period)","EIP (extrinsic incubation period)"],["day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands","day sporozoites first detected in salivary glands"],[38,33,26,30,37,43,29,25],["days","days","days","days","days","days","days","days"],[2,3,1,6,2,2,2,2],["terrestrial","terrestrial","terrestrial","terrestrial","terrestrial","terrestrial","terrestrial","terrestrial"],["laboratory","laboratory","laboratory","laboratory","laboratory","laboratory","laboratory","laboratory"],["temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation"],["realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation"],[null,null,null,null,null,null,null,null],[0,0,0,5,5,0,0,5],["Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius"],["Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles"],["stephensi","stephensi","stephensi","stephensi","stephensi","gambiae","gambiae","gambiae"],["adult","adult","adult","adult","adult","adult","adult","adult"],["female","female","female","female","female","female","female","female"],[17,18,20,16,18,17,19,19],["Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius"],[27,27,27,27,27,27,27,27],["Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius"]],"container":"<table class=\"compact stripe hover\">\n  <thead>\n    <tr>\n      <th>OriginalTraitName<\/th>\n      <th>OriginalTraitDef<\/th>\n      <th>OriginalTraitValue<\/th>\n      <th>OriginalTraitUnit<\/th>\n      <th>Replicates<\/th>\n      <th>Habitat<\/th>\n      <th>LabField<\/th>\n      <th>SecondStressor<\/th>\n      <th>SecondStressorDef<\/th>\n      <th>...10<\/th>\n      <th>SecondStressorValue<\/th>\n      <th>SecondStressorUnit<\/th>\n      <th>Interactor1Genus<\/th>\n      <th>Interactor1Species<\/th>\n      <th>Interactor1Stage<\/th>\n      <th>Interactor1Sex<\/th>\n      <th>Interactor1Temp<\/th>\n      <th>Interactor1TempUnit<\/th>\n      <th>Interactor1GrowthTemp<\/th>\n      <th>Interactor1GrowthTempUnit<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"autoWidth":true,"columnDefs":[{"width":"35px","targets":"_all"},{"className":"dt-right","targets":[2,4,10,16,18]},{"name":"OriginalTraitName","targets":0},{"name":"OriginalTraitDef","targets":1},{"name":"OriginalTraitValue","targets":2},{"name":"OriginalTraitUnit","targets":3},{"name":"Replicates","targets":4},{"name":"Habitat","targets":5},{"name":"LabField","targets":6},{"name":"SecondStressor","targets":7},{"name":"SecondStressorDef","targets":8},{"name":"...10","targets":9},{"name":"SecondStressorValue","targets":10},{"name":"SecondStressorUnit","targets":11},{"name":"Interactor1Genus","targets":12},{"name":"Interactor1Species","targets":13},{"name":"Interactor1Stage","targets":14},{"name":"Interactor1Sex","targets":15},{"name":"Interactor1Temp","targets":16},{"name":"Interactor1TempUnit","targets":17},{"name":"Interactor1GrowthTemp","targets":18},{"name":"Interactor1GrowthTempUnit","targets":19}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]},"callback":"function(table) {\n$('table.dataTable').css({'font-size': '13px'});\n$('table.dataTable tbody td').css({'padding': '1px'});\n}"},"evals":["callback"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="anopheles-gambiae-mosquitoes" class="level3">
<h3 class="anchored" data-anchor-id="anopheles-gambiae-mosquitoes">Anopheles Gambiae (mosquitoes)</h3>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8b7685b85837b6278a08" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8b7685b85837b6278a08">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"86.67\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"7\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"17\" data-max=\"19\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence","oocyst prevalence"],[0,0,0,22.73,0,5,0,13.33,40,50,40,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67,86.67],["percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent","percent"],["temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation","temperature variation"],["realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation","realistic diurnal temperature fluctuation"],[0,0,0,0,5,5,5,0,0,5,5,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5],["Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius"],["Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae","Anopheles gambiae"],[20,20,17,22,20,20,10,30,30,30,10,24,24,null,27,42,29,14,30,20,null,7,17,16,15,16,null,21,16,15,30,null,22,32,31,30,null,17,16,13,12,22,12,27,null,10],["Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia","Animalia"],["Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda","Arthropoda"],["Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles","Anopheles"],["gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae","gambiae"],["adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult","adult"],["female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female"],[17,17,17,19,19,19,19,17,19,19,19,17,17,17,17,17,19,19,19,19,19,19,19,19,19,19,19,19,17,17,17,17,17,17,19,19,19,19,19,19,19,19,19,19,19,19],["Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius"],[27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27],["Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius","Celsius"],["Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida","Haemospororida"],["Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae","Plasmodiidae"],["Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium","Plasmodium"],["falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum","falciparum"],["oocyst","oocyst and spz","oocyst and spz","oocyst and spz","oocyst and spz","oocyst and spz","spz","oocyst and spz","oocyst and spz","oocyst and spz","spz","oocyst","oocyst and spz","oocyst and spz","oocyst and spz","spz","oocyst and spz","spz","spz","spz","spz","spz","oocyst and spz","oocyst and spz","spz","spz","spz","spz","oocyst and spz","spz","spz","spz","spz","spz","oocyst and spz","spz","spz","spz","spz","spz","spz","spz","oocyst and spz","spz","spz","spz"],["table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1","table S1"]],"container":"<table class=\"compact stripe hover\">\n  <thead>\n    <tr>\n      <th>OriginalTraitName<\/th>\n      <th>OriginalTraitValue<\/th>\n      <th>OriginalTraitUnit<\/th>\n      <th>SecondStressor<\/th>\n      <th>SecondStressorDef<\/th>\n      <th>SecondStressorValue<\/th>\n      <th>SecondStressorUnit<\/th>\n      <th>Interactor1<\/th>\n      <th>Interactor1Number<\/th>\n      <th>Interactor1Kingdom<\/th>\n      <th>Interactor1Phylum<\/th>\n      <th>Interactor1Genus<\/th>\n      <th>Interactor1Species<\/th>\n      <th>Interactor1Stage<\/th>\n      <th>Interactor1Sex<\/th>\n      <th>Interactor1Temp<\/th>\n      <th>Interactor1TempUnit<\/th>\n      <th>Interactor1GrowthTemp<\/th>\n      <th>Interactor1GrowthTempUnit<\/th>\n      <th>Interactor2Order<\/th>\n      <th>Interactor2Family<\/th>\n      <th>Interactor2Genus<\/th>\n      <th>Interactor2Species<\/th>\n      <th>Interactor2Stage<\/th>\n      <th>FigureTable<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"autoWidth":true,"columnDefs":[{"width":"35px","targets":"_all"},{"className":"dt-right","targets":[1,5,8,15,17]},{"name":"OriginalTraitName","targets":0},{"name":"OriginalTraitValue","targets":1},{"name":"OriginalTraitUnit","targets":2},{"name":"SecondStressor","targets":3},{"name":"SecondStressorDef","targets":4},{"name":"SecondStressorValue","targets":5},{"name":"SecondStressorUnit","targets":6},{"name":"Interactor1","targets":7},{"name":"Interactor1Number","targets":8},{"name":"Interactor1Kingdom","targets":9},{"name":"Interactor1Phylum","targets":10},{"name":"Interactor1Genus","targets":11},{"name":"Interactor1Species","targets":12},{"name":"Interactor1Stage","targets":13},{"name":"Interactor1Sex","targets":14},{"name":"Interactor1Temp","targets":15},{"name":"Interactor1TempUnit","targets":16},{"name":"Interactor1GrowthTemp","targets":17},{"name":"Interactor1GrowthTempUnit","targets":18},{"name":"Interactor2Order","targets":19},{"name":"Interactor2Family","targets":20},{"name":"Interactor2Genus","targets":21},{"name":"Interactor2Species","targets":22},{"name":"Interactor2Stage","targets":23},{"name":"FigureTable","targets":24}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]},"callback":"function(table) {\n$('table.dataTable').css({'font-size': '13px'});\n$('table.dataTable tbody td').css({'padding': '1px'});\n}"},"evals":["callback"],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="bayesian-inference-workflow" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-inference-workflow">2. Bayesian Inference Workflow</h2>
<p>In this study, Bayesian inference is used to estimate the thermal responses of individual biological traits that drive malaria transmission. The goal is to determine how key mosquito and parasite traits vary with temperature, and ultimately, how this affects the basic reproduction number R_0.</p>
<p>The Bayesian approach proceeds in three major steps:</p>
<section id="define-a-likelihood-function" class="level3">
<h3 class="anchored" data-anchor-id="define-a-likelihood-function">1. Define a Likelihood Function</h3>
<p>For each biological trait (e.g., mosquito development rate, parasite development rate), a thermal response curve—either a Brière (asymmetric) or quadratic (symmetric) function—is chosen to describe how the trait changes with temperature. The observed data are then modeled as arising from a truncated normal distribution centered around this function, with lower truncation at zero to reflect biological constraints (e.g., traits like development rate cannot be negative). For traits that are probabilities (e.g., vector competence), a binomial likelihood is used if raw count data are available.</p>
</section>
<section id="specify-prior-distributions" class="level3">
<h3 class="anchored" data-anchor-id="specify-prior-distributions">2. Specify Prior Distributions</h3>
<p>Prior distributions are selected for the parameters of the thermal response functions, including biologically motivated temperature bounds (e.g., 0°C–45°C). Initially, uninformative priors are used to allow the data to dominate the inference. Later, informative priors are constructed by fitting the model to a broader prior dataset, and then summarizing the resulting posterior estimates to inform the main analysis. This two-step prior construction helps stabilize the inference when main data are sparse or noisy.</p>
</section>
<section id="sample-from-the-posterior-via-mcmc" class="level3">
<h3 class="anchored" data-anchor-id="sample-from-the-posterior-via-mcmc">3. Sample from the Posterior via MCMC</h3>
<p>Once likelihood and priors are specified, inference proceeds by generating posterior samples using Markov Chain Monte Carlo (MCMC) techniques such as JAGS. These samples represent plausible combinations of parameter values given both the prior knowledge and the observed data. From these, the posterior mean curves and credible intervals (e.g., 95% HPD bands) are derived to quantify uncertainty.</p>
<section id="likelihood-definition" class="level4">
<h4 class="anchored" data-anchor-id="likelihood-definition">2.1 Likelihood Definition</h4>
<p>We will use the parasite deveolpment rate (PDR) as an illustration of the general workflow. According to the paper, researchers assumed that trait values vary nonlinearly with temperature and exhibit a unimodal, asymmetric pattern. This biological response was modeled using a Brière function, a common choice for temperature-dependent traits that increase sharply, peak at an intermediate temperature, and decline at high temperatures:</p>
<p><span class="math display">\[f(T) = c \cdot T \cdot (T - T_0) \cdot \sqrt{T_m - T}, \quad \text{for } T_0 &lt; T &lt; T_m\]</span> Here: - T is the temperature (°C), - <span class="math inline">\(T_0\)</span> is the lower developmental threshold, - <span class="math inline">\(T_m\)</span> is the upper thermal limit, - c is a scaling constant.</p>
<p>To connect this deterministic curve to the observed data, we assume that each observed PDR value <span class="math inline">\(Y_i\)</span> (e.g., from a lab experiment) is a noisy realization of the theoretical value <span class="math inline">\(f(T_i)\)</span>, where <span class="math inline">\(T_i\)</span> is the temperature at which the observation was recorded. This noise is modeled using a truncated normal distribution, ensuring all simulated values remain biologically meaningful (i.e., non-negative):</p>
<p><span class="math display">\[Y_i \sim \text{Normal}\left(f(T_i), \sigma^2\right) \quad \text{truncated at } 0\]</span></p>
</section>
<section id="prior-distribution" class="level4">
<h4 class="anchored" data-anchor-id="prior-distribution">2.2 Prior Distribution</h4>
<p>In the Bayesian framework, prior distributions express our beliefs about the parameters before seeing the data. For the parasite development rate (PDR), the model includes four parameters: the lower thermal limit <span class="math inline">\(T_0\)</span>, upper thermal limit <span class="math inline">\(T_m\)</span>, a scaling constant c, and a standard deviation <span class="math inline">\(\sigma\)</span> representing observation noise.</p>
<p>Based on biological constraints and prior studies (as described in the paper and Appendix A.3), the following priors were chosen:</p>
<ul>
<li><span class="math inline">\(T_0\)</span> (lower bound of development): We assume development does not occur below roughly 5°C. So we used a truncated normal prior: <span class="math inline">\(T_0 \sim \text{Normal}(12.3, 2.5^2) \text{ truncated at } [0, ]\)</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="introduction_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><span class="math inline">\(T_m\)</span> (upper limit of development): Mosquitoes and malaria parasites typically die or stop developing near 40°C. We used: <span class="math inline">\(T_m \sim \text{Normal}(35, 1.0^2) \text{ truncated at } [T_0, 45]\)</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="introduction_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>c (scaling parameter of the Brière function): The scaling constant c controls the overall height of the thermal curve. Since it must be positive and is hard to predict precisely, we used a weakly informative gamma prior: <span class="math inline">\(c \sim \text{Gamma}(2, 40000)\)</span></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="introduction_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I honetly don’t know why we choose this but just based on the graph this puts most of the prior mass near zero but allows a long right tail.</p>
<ul>
<li><span class="math inline">\(\sigma\)</span> (standard deviation of noise): We assume the variability in the observations is positive but small. So: <span class="math inline">\(\sigma \sim \text{Uniform}(0, 1)\)</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="introduction_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="posterior-sampling-via-mcmc" class="level4">
<h4 class="anchored" data-anchor-id="posterior-sampling-via-mcmc">2.3 Posterior Sampling via MCMC</h4>
<p>Mathematically, Bayes’ theorem tells us: <span class="math inline">\(\text{Posterior} \propto \text{Likelihood} \times \text{Prior}\)</span> But in practice, this product cannot be simplified or integrated analytically, especially when our model is nonlinear (like the Brière function for PDR) and high-dimensional.</p>
<p>This is where Markov Chain Monte Carlo (MCMC) comes in as we mentioned before.</p>
<p>The Tool: JAGS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjags)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: coda</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Linked to JAGS 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded modules: basemod,bugs</code></pre>
</div>
</div>
<p>To estimate the posterior, we used JAGS (Just Another Gibbs Sampler). It allows us to simulate draws from the posterior distribution, even when the model is complex and has truncated or nonlinear components.</p>
<p>In our case, we used MCMC to sample from the joint posterior of the four parameters:<span class="math inline">\(T_0, T_m, c, \sigma\)</span></p>
<p>The Process:</p>
<p>We ran 3 parallel chains to ensure convergence from different starting points. - Each chain ran for 5000 iterations, with a 1000-iteration burn-in period to discard the early “warm-up” samples. - In total, this gave us 12,000 posterior samples (3 chains × 4000 samples each).</p>
<p>The JAGS output gave us: - Posterior means (best estimate for each parameter) - 95% credible intervals (uncertainty) - Diagnostics like effective sample size and trace plots</p>
<p>These samples allow us to: - Estimate the PDR curve across temperature - Quantify uncertainty (via credible bands) - Propagate this uncertainty into the final R_0 calculation # Inference in Bayesian framework</p>
<p>Usually proceed in three steps.</p>
<ol type="1">
<li>A likelihood is defined for each type of data.</li>
<li>Appropriate prior distributions are determined.</li>
<li>Samples from the posterior distribution of hte parameters via MCMC.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ stringr   1.5.1
✔ forcats   1.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mosquitoes1 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"the_one_we_need.xlsx"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...10`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and prepare PDR data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pdr_data <span class="ot">&lt;-</span> mosquitoes1 <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OriginalTraitName <span class="sc">==</span> <span class="st">"EIP (extrinsic incubation period)"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(Interactor1Temp),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(OriginalTraitValue)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">as.numeric</span>(Interactor1Temp),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pdr =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">as.numeric</span>(OriginalTraitValue)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(temp)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define JAGS model string</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>jags_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">    pdr[i] ~ dnorm(mu[i], tau)</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">    mu[i] &lt;- c * temp[i] * (temp[i] - T0) * sqrt(Tm - temp[i])</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="st">  # Priors (informative)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="st">  T0 ~ dnorm(14, 1 / (3.5^2))</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="st">  tm ~ dgamma(14.7, 3.1)</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="st">  Tm &lt;- 31 + tm</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="st">  c ~ dexp(100)</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="st">  # Likelihood precision</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="st">  tau &lt;- pow(sigma, -2)</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma ~ dunif(0, 10)</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Bundle data for JAGS</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>data_jags <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">temp =</span> pdr_data<span class="sc">$</span>temp,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">pdr =</span> pdr_data<span class="sc">$</span>pdr,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(pdr_data)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">T0 =</span> <span class="dv">14</span>, <span class="at">tm =</span> <span class="dv">5</span>, <span class="at">c =</span> <span class="fl">0.001</span>, <span class="at">sigma =</span> <span class="dv">1</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters to monitor</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"Tm"</span>, <span class="st">"c"</span>, <span class="st">"sigma"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the JAGS model</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(jags_model), <span class="at">data =</span> data_jags, <span class="at">inits =</span> inits, <span class="at">n.chains =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 8
   Unobserved stochastic nodes: 4
   Total graph size: 56

Initializing model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(model, <span class="dv">1000</span>)  <span class="co"># Burn-in</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> rjags<span class="sc">::</span><span class="fu">coda.samples</span>(model, <span class="at">variable.names =</span> params, <span class="at">n.iter =</span> <span class="dv">4000</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize posterior</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 2001:6000
Thinning interval = 1 
Number of chains = 3 
Sample size per chain = 4000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean        SD  Naive SE Time-series SE
T0    1.012e+01 2.186e+00 1.996e-02      1.024e-01
Tm    3.568e+01 1.241e+00 1.133e-02      1.806e-02
c     5.625e-05 1.756e-05 1.603e-07      7.750e-07
sigma 6.881e-03 2.968e-03 2.709e-05      1.021e-04

2. Quantiles for each variable:

           2.5%       25%       50%       75%     97.5%
T0    5.424e+00 8.715e+00 1.026e+01 1.164e+01 1.402e+01
Tm    3.355e+01 3.481e+01 3.559e+01 3.645e+01 3.838e+01
c     3.225e-05 4.424e-05 5.320e-05 6.435e-05 9.909e-05
sigma 3.567e-03 4.973e-03 6.152e-03 7.905e-03 1.464e-02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Extract summary statistics</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(samples)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>post_means <span class="ot">&lt;-</span> summary_stats<span class="sc">$</span>statistics[, <span class="st">"Mean"</span>]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>T0 <span class="ot">&lt;-</span> post_means[<span class="st">"T0"</span>]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>Tm <span class="ot">&lt;-</span> post_means[<span class="st">"Tm"</span>]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>c_param <span class="ot">&lt;-</span> post_means[<span class="st">"c"</span>]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define the Brière function</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>briere <span class="ot">&lt;-</span> <span class="cf">function</span>(T, T0, Tm, c) {</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> c <span class="sc">*</span> T <span class="sc">*</span> (T <span class="sc">-</span> T0) <span class="sc">*</span> <span class="fu">sqrt</span>(Tm <span class="sc">-</span> T)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  out[T <span class="sc">&lt;=</span> T0 <span class="sc">|</span> T <span class="sc">&gt;=</span> Tm] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Generate prediction ribbon from posterior draws</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>posterior_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, samples)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">45</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>pred_matrix <span class="ot">&lt;-</span> <span class="fu">apply</span>(posterior_df, <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">briere</span>(temps, row[<span class="st">"T0"</span>], row[<span class="st">"Tm"</span>], row[<span class="st">"c"</span>])</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>pred_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">temp =</span> temps,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">rowMeans</span>(pred_matrix),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwr =</span> <span class="fu">apply</span>(pred_matrix, <span class="dv">1</span>, quantile, <span class="fl">0.025</span>),</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">upr =</span> <span class="fu">apply</span>(pred_matrix, <span class="dv">1</span>, quantile, <span class="fl">0.975</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Clean observed data</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>pdr_data_clean <span class="ot">&lt;-</span> mosquitoes1 <span class="sc">%&gt;%</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OriginalTraitName <span class="sc">==</span> <span class="st">"parasite development rate (1/EIP)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">as.numeric</span>(Interactor1Temp),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">PDR =</span> <span class="fu">as.numeric</span>(OriginalTraitValue),</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">species_marker =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>      Interactor1Species <span class="sc">==</span> <span class="st">"gambiae"</span> <span class="sc">~</span> <span class="st">"An. gambiae"</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"falciparum"</span>, OriginalTraitDef, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Other anopheline"</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>      species_marker <span class="sc">==</span> <span class="st">"An. gambiae"</span> <span class="sc">~</span> <span class="dv">19</span>,  <span class="co"># solid circle</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>      species_marker <span class="sc">==</span> <span class="st">"Other anopheline"</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># plus</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">8</span>  <span class="co"># star</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(temp), <span class="sc">!</span><span class="fu">is.na</span>(PDR))</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Plot</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pred_summary, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_summary, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> mean), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pdr_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> PDR, <span class="at">shape =</span> species_marker), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"An. gambiae"</span> <span class="ot">=</span> <span class="dv">19</span>, <span class="st">"Other anopheline"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>,</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Parasite development rate, PDR"</span>,</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Species"</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="introduction_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we finally reproduced the posterior for PDR: )</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/PDR.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>